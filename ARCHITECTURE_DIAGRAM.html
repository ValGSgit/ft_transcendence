<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ft_transcendence - System Architecture Diagram</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
        }

        .badge {
            display: inline-block;
            margin-top: 1rem;
            padding: 0.5rem 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .content {
            padding: 3rem 2rem;
        }

        .diagram-wrapper {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        .mermaid {
            display: flex;
            justify-content: center;
            text-align: center;
        }

        .legend {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .legend h2 {
            margin-bottom: 1.5rem;
            color: #2c3e50;
            font-size: 1.5rem;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            background: white;
            border-radius: 8px;
            transition: transform 0.2s;
        }

        .legend-item:hover {
            transform: translateX(5px);
        }

        .color-box {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: 2px solid #dee2e6;
            flex-shrink: 0;
        }

        .color-box.infrastructure { background: #2c3e50; }
        .color-box.frontend { background: #3498db; }
        .color-box.backend { background: #e74c3c; }
        .color-box.database { background: #27ae60; }
        .color-box.external { background: #f39c12; }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .info-box h3 {
            color: #1976d2;
            margin-bottom: 0.5rem;
        }

        .info-box p {
            color: #424242;
            line-height: 1.6;
        }

        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .tech-item {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .tech-item strong {
            color: #667eea;
            display: block;
            margin-bottom: 0.5rem;
        }

        .tech-item span {
            color: #666;
            font-size: 0.9rem;
        }

        .footer {
            text-align: center;
            padding: 2rem;
            background: #f8f9fa;
            color: #666;
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .content {
                padding: 1.5rem;
            }

            .legend-grid,
            .tech-stack {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèóÔ∏è ft_transcendence System Architecture</h1>
            <p>Complete Technical Overview of the Application</p>
            <div class="badge">üõ°Ô∏è Admin Documentation</div>
        </div>

        <div class="content">
            <div class="info-box">
                <h3>üìñ About This Diagram</h3>
                <p>This architecture diagram shows the complete system structure of ft_transcendence, a modern real-time web application built for the 42 school project. The diagram illustrates all layers from infrastructure to database, including the flow of data between components.</p>
            </div>

            <div class="diagram-wrapper">
                <div class="mermaid">
graph TB
    subgraph "Infrastructure Layer"
        Docker[Docker Containers]
        Nginx[Nginx Reverse Proxy]
        SSL[Certbot SSL/TLS]
        
        Docker --> Nginx
        SSL --> Nginx
    end
    
    subgraph "Frontend Layer - Vue 3"
        VueApp[Vue Application]
        ViteServer[Vite Dev Server]
        Router[Vue Router]
        Pinia[Pinia State Management]
        ThreeJS[Three.js Engine]
        
        VueApp --> Router
        VueApp --> Pinia
        VueApp --> ThreeJS
        Vite[Vite Build] --> VueApp
    end
    
    subgraph "API Gateway"
        Express[Express.js Server]
        SocketIO[Socket.io Server]
        PassportAuth[Passport OAuth]
        
        Express --> PassportAuth
        SocketIO -.Real-time.-> Express
    end
    
    subgraph "Middleware Layer"
        AuthMW[Authentication]
        ErrorMW[Error Handler]
        AdminMW[Admin Guard]
        HelmetSec[Helmet Security]
        CORS[CORS Handler]
        
        Express --> AuthMW
        Express --> ErrorMW
        Express --> AdminMW
        Express --> HelmetSec
        Express --> CORS
    end
    
    subgraph "Controller Layer"
        AuthCtrl[Auth Controller]
        UserCtrl[User Controller]
        GameCtrl[Game Controller]
        ChatCtrl[Chat Controller]
        FriendCtrl[Friend Controller]
        PostCtrl[Post Controller]
        NotifCtrl[Notification Controller]
    end
    
    subgraph "Service Layer"
        AIService[AI Service]
        SocketService[Socket Service]
        GameEngine[Pong Game Engine]
        
        GameCtrl --> GameEngine
        ChatCtrl --> SocketService
        GameCtrl --> AIService
    end
    
    subgraph "Model Layer - ORM"
        UserModel[User Model]
        GameModel[Game Model]
        ChatModel[Chat Model]
        FriendModel[Friend Model]
        PostModel[Post Model]
        NotifModel[Notification Model]
        
        AuthCtrl --> UserModel
        UserCtrl --> UserModel
        GameCtrl --> GameModel
        ChatCtrl --> ChatModel
        FriendCtrl --> FriendModel
        PostCtrl --> PostModel
        NotifCtrl --> NotifModel
    end
    
    subgraph "Database Layer"
        DBAdapter[Database Adapter]
        SQLite[(SQLite - Dev)]
        PostgreSQL[(PostgreSQL - Prod)]
        
        DBAdapter -->|NODE_ENV=dev| SQLite
        DBAdapter -->|NODE_ENV=prod| PostgreSQL
        
        UserModel --> DBAdapter
        GameModel --> DBAdapter
        ChatModel --> DBAdapter
        FriendModel --> DBAdapter
        PostModel --> DBAdapter
        NotifModel --> DBAdapter
    end
    
    subgraph "External Services"
        OAuth42[42 OAuth]
        OAuthGoogle[Google OAuth]
        OAuthGitHub[GitHub OAuth]
        
        PassportAuth --> OAuth42
        PassportAuth --> OAuthGoogle
        PassportAuth --> OAuthGitHub
    end
    
    subgraph "Frontend Views"
        Login[Login/Register]
        Home[Home Dashboard]
        Game[Game View]
        Chat[Messages]
        Feed[Social Feed]
        Friends[Friends List]
        Profile[User Profile]
        Settings[Settings]
        Admin[Admin Panel]
        
        Router --> Login
        Router --> Home
        Router --> Game
        Router --> Chat
        Router --> Feed
        Router --> Friends
        Router --> Profile
        Router --> Settings
        Router --> Admin
    end
    
    subgraph "Frontend Services"
        APIService[API Service]
        SocketClient[Socket Client]
        AuthStore[Auth Store]
        ChatStore[Chat Store]
        SocialStore[Social Store]
        ThemeStore[Theme Store]
        
        Login --> APIService
        Home --> APIService
        Game --> APIService
        Chat --> SocketClient
        Feed --> APIService
        
        APIService --> AuthStore
        SocketClient --> ChatStore
        APIService --> SocialStore
        Settings --> ThemeStore
    end
    
    %% External Connections
    Nginx -->|Port 443 HTTPS| VueApp
    Nginx -->|/api Route| Express
    Nginx -->|WebSocket| SocketIO
    
    APIService -->|HTTP/REST| Express
    SocketClient -->|WebSocket| SocketIO
    
    %% Styling
    classDef infrastructure fill:#2c3e50,stroke:#34495e,color:#ecf0f1
    classDef frontend fill:#3498db,stroke:#2980b9,color:#ecf0f1
    classDef backend fill:#e74c3c,stroke:#c0392b,color:#ecf0f1
    classDef database fill:#27ae60,stroke:#229954,color:#ecf0f1
    classDef external fill:#f39c12,stroke:#d68910,color:#2c3e50
    
    class Docker,Nginx,SSL infrastructure
    class VueApp,Router,Pinia,ThreeJS,ViteServer,Vite frontend
    class Express,SocketIO,PassportAuth,AuthMW,ErrorMW,AdminMW backend
    class SQLite,PostgreSQL,DBAdapter database
    class OAuth42,OAuthGoogle,OAuthGitHub external
                </div>
            </div>

            <div class="legend">
                <h2>üé® Architecture Layers</h2>
                <div class="legend-grid">
                    <div class="legend-item">
                        <span class="color-box infrastructure"></span>
                        <span><strong>Infrastructure:</strong> Docker, Nginx, SSL/TLS</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box frontend"></span>
                        <span><strong>Frontend:</strong> Vue 3, Vite, Three.js</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box backend"></span>
                        <span><strong>Backend:</strong> Express, Socket.io, Passport</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box database"></span>
                        <span><strong>Database:</strong> SQLite (dev) / PostgreSQL (prod)</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box external"></span>
                        <span><strong>External:</strong> OAuth Providers (42, Google, GitHub)</span>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <h3>‚öôÔ∏è Technology Stack</h3>
                <div class="tech-stack">
                    <div class="tech-item">
                        <strong>Frontend</strong>
                        <span>Vue 3.5+, Vite 5.4+, Three.js 0.182, Pinia</span>
                    </div>
                    <div class="tech-item">
                        <strong>Backend</strong>
                        <span>Node.js 20, Express, Socket.io, Passport</span>
                    </div>
                    <div class="tech-item">
                        <strong>Database</strong>
                        <span>SQLite 3 (dev), PostgreSQL 16 (prod)</span>
                    </div>
                    <div class="tech-item">
                        <strong>Infrastructure</strong>
                        <span>Docker, Nginx, Certbot, DuckDNS</span>
                    </div>
                    <div class="tech-item">
                        <strong>Security</strong>
                        <span>JWT, bcrypt, Helmet, SSL/TLS, OAuth 2.0</span>
                    </div>
                    <div class="tech-item">
                        <strong>Real-time</strong>
                        <span>WebSocket, Socket.io, Event-driven</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>ft_transcendence ‚Ä¢ 42 School Project ‚Ä¢ System Architecture v1.0</p>
            <p style="margin-top: 0.5rem; font-size: 0.9rem;">Generated on February 12, 2026</p>
        </div>
    </div>
</body>
</html>
